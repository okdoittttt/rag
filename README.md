# Terminal RAG

í„°ë¯¸ë„ ê¸°ë°˜ì˜ ë¡œì»¬ RAG (Retrieval-Augmented Generation) ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
Pythonìœ¼ë¡œ êµ¬í˜„ë˜ì—ˆìœ¼ë©°, ë¡œì»¬ ì„ë² ë”©/ê²€ìƒ‰ê³¼ Google Gemini APIë¥¼ í™œìš©í•œ ë‹µë³€ ìƒì„±ì„ ì§€ì›í•©ë‹ˆë‹¤.

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

- **ë¬¸ì„œ ìˆ˜ì§‘ (Ingestion)**
  - `.txt`, `.md` íŒŒì¼ ì§€ì›
  - ë””ë ‰í† ë¦¬ ì¬ê·€ íƒìƒ‰ ë° ìë™ ë¡œë“œ
  - í•œêµ­ì–´/ì˜ì–´ ì–¸ì–´ ê°ì§€ ë° í…ìŠ¤íŠ¸ ì •ê·œí™”

- **ì²­í‚¹ (Chunking)**
  - ë¬¸ë§¥ ìœ ì§€ë¥¼ ìœ„í•œ ë¬¸ì¥/ë¬¸ë‹¨ ë‹¨ìœ„ ë¶„í• 
  - **Markdown êµ¬ì¡° ì¸ì‹**: í—¤ë”(#) ê¸°ë°˜ ê³„ì¸µì  ë¶„í• ë¡œ ë¬¸ë§¥ ë³´ì¡´

- **ì„ë² ë”© & ì¸ë±ì‹± (Embedding & Indexing)**
  - **SentenceTransformers**: `paraphrase-multilingual-MiniLM-L12-v2` (ë‹¤êµ­ì–´/í•œêµ­ì–´ ì§€ì›, ë¡œì»¬ ì‹¤í–‰)
  - **FAISS**: ê³ ì„±ëŠ¥ ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰ ì¸ë±ìŠ¤

- **ê²€ìƒ‰ (Retrieval)**
  - **í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰**: BM25 (í‚¤ì›Œë“œ) + Vector (ì˜ë¯¸)
  - **í•œêµ­ì–´ í˜•íƒœì†Œ ë¶„ì„**: `kiwipiepy`ë¥¼ í™œìš©í•œ ì •í™•í•œ ëª…ì‚¬/ìš©ì–¸ ì¶”ì¶œ
  - ê°€ì¤‘ì¹˜ í•©ì‚° (Weighted Sum) ë° Min-Max ì •ê·œí™” ê¸°ë°˜ ë­í‚¹

- **ë‹µë³€ ìƒì„± (Generation)**
  - **Google Gemini API**: `gemini-1.5-flash` ëª¨ë¸ ì—°ë™ (ë¬´ë£Œ í‹°ì–´ í™œìš©)
  - ê·¼ê±° ê¸°ë°˜(Context-aware) í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ (ì¶œì²˜ ì¸ìš© ê°•ì œ)

- **CLI ì¸í„°í˜ì´ìŠ¤**
  - `typer` ë° `rich` ê¸°ë°˜ì˜ ì§ê´€ì ì¸ TUI (Spinner, Markdown ì¶œë ¥)

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

| ë¶„ë¥˜ | ê¸°ìˆ  | ë¹„ê³  |
|------|------|------|
| **ì–¸ì–´** | Python 3.12+ | |
| **íŒ¨í‚¤ì§€ ê´€ë¦¬** | `uv` | Rust ê¸°ë°˜ ê³ ì† íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € |
| **CLI** | `typer`, `rich` | ì»¤ë§¨ë“œë¼ì¸ ì¸í„°í˜ì´ìŠ¤ ë° UI |
| **ì„¤ì •/ê²€ì¦** | `pydantic`, `pyyaml` | í™˜ê²½ë³€ìˆ˜ ë° YAML ì„¤ì • ê´€ë¦¬ |
| **ë¡œê¹…** | `structlog` | JSON êµ¬ì¡°í™” ë¡œê¹… ë° ë¯¼ê°ì •ë³´ ë§ˆìŠ¤í‚¹ |
| **ì„ë² ë”©** | `sentence-transformers` | ë¡œì»¬ ì„ë² ë”© ëª¨ë¸ ì‹¤í–‰ |
| **ë²¡í„° DB** | `faiss-cpu` | Meta AI ë²¡í„° ê²€ìƒ‰ ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| **í‚¤ì›Œë“œ ê²€ìƒ‰** | `rank_bm25`, `kiwipiepy` | BM25 ì•Œê³ ë¦¬ì¦˜ ë° í•œêµ­ì–´ í˜•íƒœì†Œ ë¶„ì„ |
| **LLM** | `google-generativeai` | Google Gemini API í´ë¼ì´ì–¸íŠ¸ |

## ğŸš€ ì‹œì‘í•˜ê¸°

### 1. ì„¤ì¹˜

```bash
# Repository í´ë¡ 
git clone https://github.com/your-username/terminal-rag.git
cd terminal-rag

# ì˜ì¡´ì„± ì„¤ì¹˜ (uv í•„ìš”)
uv sync
```

### 2. í™˜ê²½ ì„¤ì •

`.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  Google API í‚¤ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ([í‚¤ ë°œê¸‰ ë°›ê¸°](https://aistudio.google.com/))

```bash
# .env íŒŒì¼ ìƒì„±
echo "GOOGLE_API_KEY=your_api_key_here" > .env
```

### 3. ì‚¬ìš© ë°©ë²•

CLI ì—”íŠ¸ë¦¬í¬ì¸íŠ¸ëŠ” `cli.main` ëª¨ë“ˆì…ë‹ˆë‹¤.

#### ë¬¸ì„œ ì¸ë±ì‹± (`rag index`)

ì§€ì •ëœ ê²½ë¡œì˜ ë¬¸ì„œë¥¼ ë²¡í„° ì¸ë±ìŠ¤ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤.

```bash
# data/docs í´ë”ì˜ ëª¨ë“  ë¬¸ì„œ ì¸ë±ì‹±
python -m cli.main index ./data/docs

# ì¸ë±ìŠ¤ ì´ˆê¸°í™” í›„ ë‹¤ì‹œ ìƒì„±
python -m cli.main index ./data/docs --reset
```

#### ì§ˆë¬¸í•˜ê¸° (`rag ask`)

ì¸ë±ìŠ¤ëœ ë¬¸ì„œë¥¼ ë°”íƒ•ìœ¼ë¡œ AIê°€ ë‹µë³€í•©ë‹ˆë‹¤.

```bash
python -m cli.main ask "ì´ í”„ë¡œì íŠ¸ì˜ ì£¼ìš” ê¸°ëŠ¥ì€ ë­ì•¼?"

# ìƒì„¸ ë¡œê·¸ ë° ê²€ìƒ‰ëœ ì›ë¬¸ ì»¨í…ìŠ¤íŠ¸ í™•ì¸
python -m cli.main ask "BM25ê°€ ë­ì•¼?" --verbose --show-context
```

#### ê²€ìƒ‰ ê²°ê³¼ í™•ì¸ (`rag search`)

LLM ë‹µë³€ ìƒì„± ì—†ì´, ê²€ìƒ‰ëœ ì²­í¬(Chunk)ë¥¼ ì§ì ‘ í™•ì¸í•©ë‹ˆë‹¤. (ë””ë²„ê¹…ìš©)

```bash
python -m cli.main search "ì²­í‚¹ ì „ëµ" --top-k 5
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
terminal-rag/
â”œâ”€â”€ cli/                 # CLI ëª…ë ¹ì–´ êµ¬í˜„ (typer)
â”œâ”€â”€ configs/             # ê¸°ë³¸ ì„¤ì • íŒŒì¼ (default.yaml)
â”œâ”€â”€ data/                # ë°ì´í„° ì €ì¥ì†Œ (ì¸ë±ìŠ¤ ë“±)
â”œâ”€â”€ src/
â”‚   â””â”€â”€ rag/
â”‚       â”œâ”€â”€ chunking/    # í…ìŠ¤íŠ¸ ë¶„í•  ë¡œì§
â”‚       â”œâ”€â”€ embedding/   # ì„ë² ë”© ë° ë²¡í„° ì €ì¥ì†Œ
â”‚       â”œâ”€â”€ generation/  # LLM ì—°ë™ ë° í”„ë¡¬í”„íŠ¸
â”‚       â”œâ”€â”€ ingestion/   # ë¬¸ì„œ ë¡œë”© ë° ì •ê·œí™”
â”‚       â”œâ”€â”€ retrieval/   # ê²€ìƒ‰ ì—”ì§„ (Hybrid)
â”‚       â”œâ”€â”€ config.py    # ì„¤ì • ê´€ë¦¬
â”‚       â””â”€â”€ logger.py    # ë¡œê¹… ëª¨ë“ˆ
â””â”€â”€ tests/               # ë‹¨ìœ„ ë° í†µí•© í…ŒìŠ¤íŠ¸
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
uv run pytest
```
